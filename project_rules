# 单元测试生成规范

## 1. 基本原则

1. 遵循 Arrange-Act-Assert (AAA) 模式
2. 每个测试方法只测试一个功能点
3. 测试方法之间保持独立，不共享状态
4. 使用清晰、描述性的测试方法命名

## 2. 命名规范

### 2.1 类命名
- 测试类命名：被测试类名 + Test，例如 OrderServiceTest

### 2.2 方法命名
- 测试方法命名格式：test + 被测试方法名 + _ + 测试场景描述 + _ + 预期结果
- 例如：testCreateOrder_ValidOrder_ReturnsTrue

### 2.3 测试用例编号
- 使用 TC 开头的编号标识测试用例，如 TC001、TC002 等
- 在测试方法的注释中注明测试用例编号

## 3. 代码结构

### 3.1 类级别注释
- 使用 /** */ 格式对测试类进行功能说明

### 3.2 方法级别注释
- 每个测试方法前添加注释，包含：
  - 测试用例编号
  - 测试场景描述
  - 预期结果

### 3.3 测试方法结构
```java
@Test
void testMethodName_Scenario_ExpectedResult() {
    // 准备测试数据 (Arrange)
    // 执行测试 (Act)
    // 验证结果 (Assert)
}
```

## 4. Mock 规范

### 4.1 Mock 对象创建
- 在 @BeforeEach 方法中创建 Mock 对象
- 使用 Mockito.mock() 方法创建 Mock 对象

### 4.2 Mock 行为配置
- 使用 Mockito.when().thenReturn() 配置 Mock 对象的行为
- 使用 Mockito.verify() 验证方法调用

## 5. 断言规范

### 5.1 基本断言
- 使用 JUnit 5 的 Assertions 类进行断言
- 优先使用 assertTrue()、assertFalse()、assertEquals() 等方法

### 5.2 异常断言
- 使用 assertThrows() 方法测试异常情况
- 验证异常消息内容

## 6. 测试生命周期

### 6.1 @BeforeEach
- 用于测试前的初始化工作
- 创建被测试对象实例
- 初始化 Mock 对象

### 6.2 @AfterEach
- 用于测试后的清理工作
- 清空对象引用，避免测试间相互影响

## 7. 测试覆盖要求

### 7.1 分支覆盖
- 为每个分支路径创建独立的测试方法
- 确保所有条件分支都被测试

### 7.2 边界值测试
- 测试边界条件和异常情况
- 包括输入为空、为零、为负等场景

### 7.3 正常流程测试
- 测试正常业务流程
- 验证正确输入下的预期输出

## 8. 测试数据管理

### 8.1 测试数据创建
- 创建私有辅助方法生成测试数据
- 保证测试数据的一致性和可维护性

### 8.2 测试数据隔离
- 每个测试方法使用独立的测试数据
- 避免测试间数据污染

## 9. 依赖管理

### 9.1 测试依赖
- 使用 Maven 管理测试依赖
- 主要依赖：JUnit 5、Mockito

### 9.2 依赖注入
- 通过匿名内部类或 setter 方法注入 Mock 对象
- 确保被测试对象使用的是 Mock 依赖而非真实依赖